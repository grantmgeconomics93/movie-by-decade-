---
title: "Untitled"
output: github_document
date: "2022-08-16"
---

```{r setup, include=FALSE}
options(scipen = 999)
library(readxl)
moviemoney <- read_excel("moviemoney.xlsx", 
    col_types = c("numeric", "skip", "skip", 
        "numeric", "date", "numeric", "numeric", 
        "text"))
View(moviemoney)
```

```{r,echo=FALSE}
library(dplyr)
library(tidyr)
library(ggfortify)
library(mltools)
library(data.table)
library(fastDummies)
library(caret)
#disable Scientific notation 
options(scipen = 999)
```




```{r}
#eliminating the numeric values
moviepredum=data.frame(year=as.numeric(gsub('-..*','',moviemoney$release_date ))%/%10 *10,title=moviemoney$title)%>%filter(year>1959)
```
```{r}
#eliminating the numeric values
first =data.frame(year=as.numeric(gsub('-..*','',moviemoney$release_date ))%/%10 *10,title=moviemoney$title)%>%filter( year==2000|year==2010 |year==1990|year==1980|year==1970)
```
```{r}
sec=dummy_cols(first,"year",remove_first_dummy = TRUE)
```

```{r}

dummyfulldata=merge(sec,moviemoney,"title")


```
```{r}
summary(lm(dummyfulldata$budget~dummyfulldata$year_1980+dummyfulldata$year_1990+dummyfulldata$year_2000+dummyfulldata$year_2010))


```

```{r}

length(which(moviefindum$year_1970==1))
length(which(moviefindum$year_1980==1))
length(which(moviefindum$year_1990==1))
length(which(moviefindum$year_2000==1))
length(which(moviefindum$year_2010==1))
```
```{r}
finalcut=merge(moviemoney,moviefindum,"title")
```



```{r}
newdata <- one_hot(as.data.table(decade))
decade$dec <- as.factor(decade$dec)
newdata <- one_hot(as.data.table(decade))


```
```{r}
dmy <- dummyVars(" ~ dec", data =decade)
dumdum5 <- data.frame(predict(dmy, newdata = decade))
dum6=cbind(newdata$title,dumdum5)
```

```{r}
hollywoo3$gross=hollywoo3$revenue - hollywoo3$budget
```

```{r}
ggdistribution(dnorm,x = finalcut$budget,mean = mean(finalcut$budget),sd = sd(finalcut$budget))
ggdistribution(dnorm,x = finalcut$revenue,mean = mean(finalcut$revenue),sd = sd(finalcut$revenue))
```

```{r}

budgetholly=slice_min(finalcut,budget,n=3518)
ggdistribution(dnorm,x = finalcut$budget,mean = mean(finalcut$budget),sd = sd(finalcut$budget))
revenueholly=slice_min(finalcut,revenue,n=3518)
ggdistribution(dnorm,x = finalcut$budget,mean = mean(finalcut$budget),sd = sd(finalcut$budget))
```
```{r}

summary(lm(finalcut$budget~finalcut$runtime+finalcut$year_1970))
summary(lm(finalcut$budget~finalcut$runtime+finalcut$year_1980))


```
```{r}
mean(hollywoo3$budget[hollywoo3$dec_1960==1])
mean(hollywoo3$budget[hollywoo3$dec_1970==1])
mean(hollywoo3$budget[hollywoo3$dec_1980==1])
mean(hollywoo3$budget[hollywoo3$dec_1990==1])

```

```{r}
summary(lm(budgetholly$budget~budgetholly$revenue))
```
```{r}
mean(biggestmovie$budget[biggestmovie$`1990s`==1])
```




