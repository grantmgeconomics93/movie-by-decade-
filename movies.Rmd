---
title: "Untitled"
output: github_document
date: "2022-08-16"
---

```{r setup, include=FALSE}
options(scipen = 999)
library(readxl)
moviemoney <- read_excel("moviemoney.xlsx", 
    col_types = c("numeric", "skip", "skip", 
        "numeric", "date", "numeric", "numeric", 
        "text"))
View(moviemoney)
```

```{r,echo=FALSE}
library(dplyr)
library(tidyr)
library(ggfortify)
library(mltools)
library(data.table)
library(fastDummies)
#library(caret)
library(tidyverse)
#disable Scientific notation 
options(scipen = 999)
```



```{r}
#create a dataframe for creating dummies  with two columns the decade when the movie was made byand the title of the movie 
first =data.frame(year=as.numeric(gsub('-..*','',moviemoney$release_date ))%/%10 *10,title=moviemoney$title)%>%filter( year==2000|year==2010 |year==1990|year==1980)
```
```{r}
#create dummies per decade 
sec=dummy_cols(first,"year")
```

```{r}
# merge dummies to "moviemoney" to dummies so we can compare data to financial data 
dummyfulldata=merge(sec,moviemoney,"title")


```
```{r}
#get rid of the top budget and revenue movies to get a understanding of the "block buster"effect where the biggest movies drive sells

tt=subset(dummyfulldata,year==1980)%>%slice_min(revenue,n =180)
to=subset(dummyfulldata,year==1990)%>%slice_min(revenue,n =678)
tb=subset(dummyfulldata,year==2000)%>%slice_min(revenue,n =1950)
tf=subset(dummyfulldata,year==2010)%>%slice_min(revenue,n =1347)

```
```{r}
#exblockbuster=reduce(merge,(tt,to,tb,tf))
exblockbuster=rbind(tt,to,tb,tf)

```

```{r}
summary(lm(dummyfulldata$budget~dummyfulldata$year_1990+dummyfulldata$year_2000+dummyfulldata$year_2010))


```
```{r}
summary(lm(exblockbuster$budget~exblockbuster$year_1990+exblockbuster$year_2000+exblockbuster$year_2010))
```

```{r}

```


```{r}
#trying different dummyways to create dummy column 
newdata <- one_hot(as.data.table(decade))
decade$dec <- as.factor(decade$dec)
newdata <- one_hot(as.data.table(decade))



dmy <- dummyVars(" ~ dec", data =decade)
dumdum5 <- data.frame(predict(dmy, newdata = decade))
dum6=cbind(newdata$title,dumdum5)
```



```{r}
ggdistribution(dnorm,x = dummyfulldata$budget,mean = mean(dummyfulldata$budget),sd = sd(dummyfulldata$budget))

ggdistribution(dnorm,x = exblockbuster$budget,mean = mean(exblockbuster$budget),sd = sd(exblockbuster$budget))

```

```{r}



```
