---
title: "Untitled"
output: github_document
date: "2022-08-16"
---

```{r setup, include=FALSE}
options(scipen = 999)
library(readxl)
moviemoney <- read_excel("moviemoney.xlsx", 
    col_types = c("numeric", "skip", "skip", 
        "numeric", "date", "numeric", "numeric", 
        "text"))
View(moviemoney)
```

```{r,echo=FALSE}
library(dplyr)
library(tidyr)
library(ggfortify)
library(mltools)
library(data.table)
library(fastDummies)
library(caret)
#disable Scientific notation 
options(scipen = 999)
```



```{r}
#create a dataframe for creating dummies  with two columns the decade when the movie was made byand the title of the movie 
first =data.frame(year=as.numeric(gsub('-..*','',moviemoney$release_date ))%/%10 *10,title=moviemoney$title)%>%filter( year==2000|year==2010 |year==1990|year==1980|year==1970)
```
```{r}
#create dummies per decade 
sec=dummy_cols(first,"year",remove_first_dummy = FALSE)
```

```{r}
# merge dummies to "moviemoney" to dummies so we can compare data to financial data 
dummyfulldata=merge(sec,moviemoney,"title")


```
```{r}
#get rid of the top budget and revenue movies to get a understanding of the "block buster"effect where the biggest movies drive sells

buddummy=slice_min(dummyfulldata,budget,n=4564)

revdummy=slice_min(dummyfulldata,revenue,n=4564)

```

```{r}
summary(lm(dummyfulldata$budget~dummyfulldata$year_1980+dummyfulldata$year_1990+dummyfulldata$year_2000+dummyfulldata$year_2010))


```
```{r}
summary(lm(buddummy$budget~buddummy$year_1980+buddummy$year_1990+buddummy$year_2000+buddummy$year_2010))
```



```{r}
#trying different dummyways to create dummy column 
newdata <- one_hot(as.data.table(decade))
decade$dec <- as.factor(decade$dec)
newdata <- one_hot(as.data.table(decade))



dmy <- dummyVars(" ~ dec", data =decade)
dumdum5 <- data.frame(predict(dmy, newdata = decade))
dum6=cbind(newdata$title,dumdum5)
```



```{r}
ggdistribution(dnorm,x = dummyfulldata$budget,mean = mean(dummyfulldata$budget),sd = sd(dummyfulldata$budget))
ggdistribution(dnorm,x = dummyfulldata$revenue,mean = mean(dummyfulldata$revenue),sd = sd(dummyfulldata$revenue))
```

```{r}

buddummy=slice_min(dummyfulldata,budget,n=4564)
ggdistribution(dnorm,x = dummyfulldata$budget,mean = mean(dummyfulldata$budget),sd = sd(dummyfulldata$budget))
revdummy=slice_min(dummyfulldata,revenue,n=4564)

```
