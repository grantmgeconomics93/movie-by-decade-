---
title: "Untitled"
output: github_document
date: "2022-08-16"
---

```{r setup, include=FALSE}
library(readxl)
Movies <- read_excel("~/git/movie-by-decade-/Movies.xlsx")
View(Movies)
library(readxl)
moviemoney <- read_excel("moviemoney.xlsx", 
    col_types = c("numeric", "skip", "skip", 
        "numeric", "date", "numeric", "numeric", 
        "text"))
View(moviemoney)
```

```{r,results='hide'}
library(dplyr)
library(tidyr)
library(ggfortify)
library(mltools)
library(data.table)
#disable Scientific notation 
options(scipen = 999)
```


```{r,}
Movies=mutate(Movies,"do people really mess with it like that "=dense_rank(vote_average))
```


```{r}
Movies$releasedate2=Movies$release_date%>%as.character()
```


```{r}
year=separate(Movies,releasedate2,c("date","year"),"-")
names(year)[4]="title"
years=subset(year,select = c("title","date"))
```
```{r}
names(Movies)[4]="title"
#cleaned biggest movie to remove unnecessary data
Movies$overview=NULL
Movies$title...7=NULL
#Hollywood <- subset(Movies, select = -c(3))
themovie=cbind(years[2],Movies )
```


```{r}
decade=data.frame(title=as.character(themovie$title))

decade$dec=as.numeric(year$date)%/%10*10
```


```{r}
newdata <- one_hot(as.data.table(decade))
decade$dec <- as.factor(decade$dec)
newdata <- one_hot(as.data.table(decade))


```

  
```{r}
hollywoo3=merge(newdata,themovie,by="title")
hollyhoo3$...1=NULL
hollyhoo3$id=NULL

```



```{r}
Hollywoo3$gross=Hollywoo2$revenue - Hollywoo2$budget
```

```{r}
ggdistribution(dnorm,x = Hollywoo2$budget,mean = mean(Hollywoo2$budget),sd = sd(Hollywoo2$budget))
ggdistribution(dnorm,x = Hollywoo2$revenue,mean = mean(Hollywoo2$revenue),sd = sd(Hollywoo2$revenue))
```

```{r}

budgetholly2=Hollywoo2%>%slice_min(budget,n=3518)
ggdistribution(dnorm,x = Hollywoo2$budget,mean = mean(Hollywoo2$budget),sd = sd(Hollywoo2$budget))
revenueholll2=slice_min(Hollywoo2,revenue,n=3518)
ggdistribution(dnorm,x = Hollywoo2$budget,mean = mean(rslicedmovierten$budget),sd = sd(rslicedmovierten$budget))
```


```{r}
ggdistribution(pnorm,x = biggestmovie$budget,mean = mean(biggestmovie$budget),sd = sd(biggestmovie$budget))


```
```{r}
summary(lm(biggestmovie$budget~biggestmovie$revenue))

```
```{r}
summary(lm(bslicedmovieten$budget~bslicedmovieten$revenue))
```
```{r}
mean(biggestmovie$budget[biggestmovie$`1990s`==1])
```




